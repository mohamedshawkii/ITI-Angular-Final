<div class="mt-4 p-2">
  <h3 class="section-title mb-4">My Active Orders</h3>
  <table class="table table-striped table-bordered mb-4 grid-4 users-table">
    <thead class="table-dark">
      <tr>
        <th class="text-left">Order Date</th>
        <th class="text-left">Status</th>
        <th class="text-left">Order Details</th>
        <th class="text-left">Payment Method</th>
        <th class="text-left">Actions</th>
      </tr>
    </thead>
    <tbody>
      @for (order of orders; track order.id) {
      <tr>
        <td>{{ order.orderDate | date : "shortDate" }}</td>

        <td>
          @switch( order.status){ @case (1) {
          <span class="badge bg-primary">Out For Delivery</span> } @case (2) {
          <span class="badge bg-success">Delivered</span> } @case (3) {
          <span class="badge bg-danger">Cancelled</span> } @case (4) {
          <span class="badge bg-warning text-dark"
            >Delivery Brand Handing Request</span
          >
          } @case (5) {
          <span class="badge bg-info">Delivery User Handing Request</span> }
          @case (6) {
          <span class="badge bg-secondary">User Delivery Handing Request</span>
          } @case (7) { <span class="badge bg-dark">Returning</span> } @case (8)
          { <span class="badge bg-dark">CashOntheWay</span> } @case (10) {
          <span class="badge bg-dark">CashToBrandHandingRequest</span> }@default
          { <span class="badge bg-secondary">Checking</span> } }
        </td>

        <td>
          <ul class="list-unstyled order-details-list">
            @for (_order of order.orderDetails; track $index) {
            <li>
              Price: \${{ _order.price | number : "1.2-2" }}, Qty:
              {{ _order.quantity }}
            </li>
            }
          </ul>
        </td>
        <td>{{ order.paymentMethod || "checking" }}</td>

        <td>
          <div class="d-flex flex-column gap-3">
            @if(order.status === 6){
            <button
              class="btn btn-sm btn-warning action-btn"
              (click)="ReturningOrder(order)"
            >
              <i class="fas fa-undo"></i> Returning Order
            </button>
            } @else if(order.status === 1){
            <!-- <button
              class="btn btn-sm btn-danger action-btn"
              (click)="GiveUpOrder(order.id, DeliveryID)"
            >
              <i class="fas fa-times-circle"></i> Cancel Order
            </button> -->
            <button
              class="btn btn-sm btn-success action-btn"
              (click)="DeliveryUserHandingRequest(order)"
            >
              <i class="fas fa-check-circle"></i> Deliver
            </button>
            }@else if(order.status === 8){
            <button
              class="btn btn-sm btn-success action-btn"
              (click)="CashBrandHandingRequest(order)"
            >
              <i class="fas fa-check-circle"></i> Deliver Cash to Brand
            </button>
            }@else {
            <p class="no-action-text">
              <i class="fas fa-info-circle"></i> No Action needed
            </p>
            }
          </div>
        </td>
      </tr>
      } @empty {
      <tr>
        <td colspan="5" class="text-center py-3">No active orders found.</td>
      </tr>
      }
    </tbody>
  </table>
  <nav>
    <ul class="pagination justify-content-center mb-4">
      <li class="page-item" [class.disabled]="currentPage === 1">
        <button class="page-link" (click)="prevPage()">Previous</button>
      </li>

      @for (page of totalPagesArray; track page) {
      <li class="page-item" [class.active]="currentPage === page">
        <button class="page-link" (click)="goToPage(page)">{{ page }}</button>
      </li>
      }

      <li class="page-item" [class.disabled]="currentPage === totalPages">
        <button class="page-link" (click)="nextPage()">Next</button>
      </li>
    </ul>
  </nav>
</div>
